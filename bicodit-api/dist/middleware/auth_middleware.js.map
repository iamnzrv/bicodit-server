{"version":3,"sources":["../../src/middleware/auth_middleware.js"],"names":["TOKENTIME","SECRET","authenticate","secret","generateAccessToken","req","res","next","token","jwt","sign","id","user","expiresIn","respond","status","json","respondWithData","userData","email","login","avatar","profileName","name","profileInfo","about","module","exports"],"mappings":";;AAAA;;AACA;;AACA;;;;AAEA,IAAMA,SAAS,GAAG,KAAG,EAAH,GAAM,EAAN,GAAS,EAA3B;AACA,IAAMC,MAAM,GAAG,mBAAf;AAEA,IAAIC,YAAY,GAAG,4BAAW;AAAEC,EAAAA,MAAM,EAAEF;AAAV,CAAX,CAAnB;;AAEA,IAAIG,mBAAmB,GAAG,SAAtBA,mBAAsB,CAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC5CF,EAAAA,GAAG,CAACG,KAAJ,GAAYH,GAAG,CAACG,KAAJ,IAAa,EAAzB;AACAH,EAAAA,GAAG,CAACG,KAAJ,GAAYC,yBAAIC,IAAJ,CAAU;AACpBC,IAAAA,EAAE,EAAEN,GAAG,CAACO,IAAJ,CAASD;AADO,GAAV,EAETV,MAFS,EAED;AACTY,IAAAA,SAAS,EAAEb,SADF,CACY;;AADZ,GAFC,CAAZ;AAKAO,EAAAA,IAAI;AACL,CARD;;AAUA,IAAIO,OAAO,GAAG,SAAVA,OAAU,CAACT,GAAD,EAAMC,GAAN,EAAc;AAC1BA,EAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBR,IAAAA,KAAK,EAAEH,GAAG,CAACG;AADQ,GAArB;AAGD,CAJD;;AAMA,IAAIS,eAAe,GAAG,SAAlBA,eAAkB,CAACZ,GAAD,EAAMC,GAAN,EAAc;AAClCA,EAAAA,GAAG,CAACS,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB;AACnBR,IAAAA,KAAK,EAAEH,GAAG,CAACG,KADQ;AAEnBU,IAAAA,QAAQ,EAAE;AACRP,MAAAA,EAAE,EAAEN,GAAG,CAACM,EADA;AAERQ,MAAAA,KAAK,EAAEd,GAAG,CAACc,KAFH;AAGRC,MAAAA,KAAK,EAAEf,GAAG,CAACe,KAHH;AAIRC,MAAAA,MAAM,EAAEhB,GAAG,CAACgB,MAAJ,IAAc,cAJd;AAKRC,MAAAA,WAAW,EAAEjB,GAAG,CAACkB,IAAJ,IAAY,EALjB;AAMRC,MAAAA,WAAW,EAAEnB,GAAG,CAACoB,KAAJ,IAAa;AANlB;AAFS,GAArB;AAWD,CAZD;;AAcAC,MAAM,CAACC,OAAP,GAAiB;AACfzB,EAAAA,YAAY,EAAZA,YADe;AAEfE,EAAAA,mBAAmB,EAAnBA,mBAFe;AAGfU,EAAAA,OAAO,EAAPA,OAHe;AAIfG,EAAAA,eAAe,EAAfA;AAJe,CAAjB","sourcesContent":["import jwt from 'jsonwebtoken';\nimport expressJwt from 'express-jwt';\nimport jwtDecode from 'jwt-decode';\n\nconst TOKENTIME = 60*60*24*90;\nconst SECRET = \"Obee1UrMyOnlyH0pe\";\n\nlet authenticate = expressJwt({ secret: SECRET });\n\nlet generateAccessToken = (req, res, next) => {\n  req.token = req.token || {};\n  req.token = jwt.sign ({\n    id: req.user.id,\n  }, SECRET, {\n    expiresIn: TOKENTIME // 90 days\n  });\n  next();\n}\n\nlet respond = (req, res) => {\n  res.status(200).json({\n    token: req.token\n  });\n}\n\nlet respondWithData = (req, res) => {\n  res.status(200).json({\n    token: req.token,\n    userData: {\n      id: req.id,\n      email: req.email,\n      login: req.login,\n      avatar: req.avatar || \"rabbodefault\",\n      profileName: req.name || \"\",\n      profileInfo: req.about || \"\"\n    }\n  });\n}\n\nmodule.exports = {\n  authenticate,\n  generateAccessToken,\n  respond,\n  respondWithData\n}\n"],"file":"auth_middleware.js"}